  - platform: nordpool
    region: SE3
    currency: SEK
  - platform: time_date
    display_options:
      - 'time'
      - 'date'
      - 'date_time'
  - platform: template
    sensors:
      zigge_distance_bt:
        friendly_name: Zigge BT distance
        unit_of_measurement: 'm'
        value_template: >-
          {{ 0 if state_attr('sensor.c4c141327127_room_presence', 'distance') is none else "%.1f"|format( states.sensor.c4c141327127_room_presence.attributes.distance) }}
      pelles_phone_distance_bt:
        friendly_name: Pelles phone BT distance
        unit_of_measurement: 'm'
        value_template: >-
          {{ 0 if state_attr('sensor.pelles_phone_room_presence', 'distance') is none else "%.1f"|format( states.sensor.pelles_phone_room_presence.attributes.distance) }}
  #BV energy sensor
      bv_approx_power:
        friendly_name: Heat pump power
        unit_of_measurement: 'W'
        value_template: >-
          {{ (0 if states('binary_sensor.bv_compressor') == 'off' else 1) * (states.input_number.bv_compressor_approx_power.state | float) }}
  #Car charging energy sensor
      ar_approx_power:
        friendly_name: Car charge power
        unit_of_measurement: 'W'
        value_template: >-
          {{ (0 if states('switch.arteon_charging') == 'off' else 1) * (states.input_number.approx_power_when_charging_car.state | float) }}
  #VPN sensor
      # vpn_simple:
      #   friendly_name: VPN simple
      #   value_template: >-
      #     {% for row in states.sensor.vpn_clients.state.split('\n') -%}
      #       {% for value in row.split('--') -%}
      #         {% if loop.index <= 2 -%}
      #           {{ value }}
      #         {%- endif %}
      #         {% if loop.index <= 1 -%}
      #           {{ ' ' }}
      #         {%- endif %}
      #       {%- endfor %}
      #       {{'\n'}}
      #     {%- endfor %}
  #Others
      solar_angle:
        value_template: '{{ "%+.1f"|format(states.sun.sun.attributes.elevation) }}'
        friendly_name: 'Sun Angle'
        unit_of_measurement: '°'
      sunrise:
        friendly_name: 'Sunrise'
        value_template: >-
          {{ as_timestamp(states.sun.sun.attributes.next_rising) | timestamp_custom(' %H:%M') | replace(" 0", "") }}
        icon_template: mdi:weather-sunset-up
      sunset:
        friendly_name: 'Sunset'
        value_template: >-
          {{ as_timestamp(states.sun.sun.attributes.next_setting) | timestamp_custom(' %H:%M') | replace(" 0", "") }}
        icon_template: mdi:weather-sunset-down
      roger_battery:
        friendly_name: 'Roger battery level'
        value_template: "{{ state_attr('vacuum.automower_r_310_roger', 'battery_level') }}"
        unit_of_measurement: '%'
        device_class: battery
      wind_bearing:
        friendly_name: 'Wind direction'
        value_template: '{{ state_attr("weather.smhi_home", "wind_bearing") }}'
        unit_of_measurement: '°'
        icon_template: mdi:weather-windy-variant

      # pelle_velocity:
      #   friendly_name: 'Pelle velocity'
      #   value_template: '{{ (states.device_tracker.per_per.attributes.velocity * 3.542) | int }}'
      #   unit_of_measurement: 'kmh'
      # marie_velocity:
      #   friendly_name: 'Marie velocity'
      #   value_template: "{{ state_attr('device_tracker.marie_marie', 'velocity') | int }}"
      #   unit_of_measurement: 'kmh'
      # frida_velocity:
      #   friendly_name: 'Frida velocity'
      #   value_template: '{{ (states.device_tracker.frida_frida.attributes.velocity * 3.542) | int}}'
      #   unit_of_measurement: 'kmh'
      # jenny_velocity:
      #   friendly_name: 'Jenny velocity'
      #   value_template: '{{ (states.device_tracker.jenny_jenny.attributes.velocity * 3.542) | int}}'
      #   unit_of_measurement: 'kmh'
      # albin_velocity:
      #   friendly_name: 'Albin velocity'
      #   value_template: '{{ (states.device_tracker.albin_albin.attributes.velocity * 3.542) | int}}'
      #   unit_of_measurement: 'kmh'
  - platform: integration
    source: sensor.bv_approx_power
    name: heat_pump_energy
    method: left
    unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.ar_approx_power
    name: arteon_charging_energy
    method: left
    unit_prefix: k
    round: 2
  - platform: systemmonitor
    resources:
      - type: disk_use_percent
        arg: /
      - type: disk_free
        arg: /
      - type: memory_use_percent
      - type: memory_free
      - type: load_1m
      - type: load_5m
      - type: load_15m
      - type: processor_use
      - type: throughput_network_in
        arg: hassio
      - type: throughput_network_out
        arg: hassio
      - type: last_boot
  - platform: aarlo
    monitored_conditions:
    - total_cameras
    - last_capture
    - recent_activity
    - captured_today
    - battery_level
    - signal_strength
    - temperature
    - humidity
    - air_quality
  - platform: google_wifi
    host: 192.168.86.1
  - platform: sjofartsverket_viva
    name: Vind Sandhamn
    region: 80
    scan_interval: 120
  - platform: sjofartsverket_viva
    name: Vind Söderarm
    region: 166
    scan_interval: 120
  - platform: sjofartsverket_viva
    name: Vind Landsort
    region: 2
    scan_interval: 120
# HASL Hass SL integration
#  - platform: hasl
#    ri4key: !secret sl_ri4_key
#    si2key: !secret sl_si2_key
#    tl2key: !secret sl_tl2_key
#    sensors:
#    - friendly_name: Klisätravägen
#      sensor_type: departures
#      siteid: 4612
#      lines: ['401']
#      direction: 2
#    # - friendly_name: Trafikstatus
#    #   sensor_type: status
  - platform: history_stats
    name: Hours worked today
    entity_id: sensor.pelle_work_status
    state:
      - 'At OKQ8'
      - 'At Home'
    type: time
    start: "{{ now().replace(hour=0, minute=0, second=0, microsecond=0) }}"
    end: "{{ now() }}"